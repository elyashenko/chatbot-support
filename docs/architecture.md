# ะััะธัะตะบัััะฐ RAG Chatbot Support System

## ๐๏ธ ะะฑัะฐั ะฐััะธัะตะบัััะฐ

ะกะธััะตะผะฐ ะฟะพัััะพะตะฝะฐ ะฟะพ ะฟัะธะฝัะธะฟั **RAG (Retrieval-Augmented Generation)** - ััะพ ัะพะฒัะตะผะตะฝะฝัะน ะฟะพะดัะพะด ะบ ัะพะทะดะฐะฝะธั ะะ-ะฐััะธััะตะฝัะพะฒ, ะบะพัะพััะน ัะพัะตัะฐะตั ะฟะพะธัะบ ะฟะพ ะฑะฐะทะต ะทะฝะฐะฝะธะน ั ะณะตะฝะตัะฐัะธะตะน ะพัะฒะตัะพะฒ.

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Frontend      โ    โ    Backend      โ    โ  Vector Store   โ
โ   (React)       โโโโโบโ   (FastAPI)     โโโโโบโ   (ChromaDB)    โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โ                       โ                       โ
         โผ                       โผ                       โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   WebSocket     โ    โ   PostgreSQL    โ    โ  Embeddings     โ
โ   Connection    โ    โ   Database      โ    โ   Model         โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะฐะบ ัะฐะฑะพัะฐะตั RAG

### 1. **ะะฝะดะตะบัะฐัะธั ะดะพะบัะผะตะฝัะพะฒ**
```
ะะพะบัะผะตะฝั โ ะะฐะทะฑะธะตะฝะธะต ะฝะฐ ัะฐะฝะบะธ โ ะะตะบัะพัะธะทะฐัะธั โ ะกะพััะฐะฝะตะฝะธะต ะฒ ChromaDB
```

### 2. **ะะฑัะฐะฑะพัะบะฐ ะทะฐะฟัะพัะฐ ะฟะพะปัะทะพะฒะฐัะตะปั**
```
ะะพะฟัะพั โ ะะตะบัะพัะธะทะฐัะธั โ ะะพะธัะบ ะฟะพัะพะถะธั ัะฐะฝะบะพะฒ โ ะะพะฝัะตะบัั + ะะพะฟัะพั โ LLM โ ะัะฒะตั
```

### 3. **ะะตัะฐะปัะฝัะน ะฟัะพัะตัั**

#### ะจะฐะณ 1: ะะตะบัะพัะธะทะฐัะธั ะฒะพะฟัะพัะฐ
- ะะพะปัะทะพะฒะฐัะตะปั ะทะฐะดะฐะตั ะฒะพะฟัะพั
- ะกะธััะตะผะฐ ะฟัะตะพะฑัะฐะทัะตั ะฒะพะฟัะพั ะฒ ะฒะตะบัะพั ั ะฟะพะผะพััั ะผะพะดะตะปะธ `sentence-transformers`
- ะัะฟะพะปัะทัะตััั ะผะพะดะตะปั `all-MiniLM-L6-v2` (ะฑััััะฐั ะธ ัััะตะบัะธะฒะฝะฐั)

#### ะจะฐะณ 2: ะะพะธัะบ ัะตะปะตะฒะฐะฝัะฝะพะณะพ ะบะพะฝัะตะบััะฐ
- ะกะธััะตะผะฐ ะธัะตั ะฒ ะฒะตะบัะพัะฝะพะน ะฑะฐะทะต ัะฐะฝะบะธ, ะฟะพัะพะถะธะต ะฝะฐ ะฒะพะฟัะพั
- ะัะธะผะตะฝัะตััั **ะณะธะฑัะธะดะฝัะน ะฟะพะธัะบ**:
  - **ะะตะบัะพัะฝัะน ะฟะพะธัะบ**: ะฟะพ ัะตะผะฐะฝัะธัะตัะบะพะผั ััะพะดััะฒั
  - **ะะปััะตะฒะพะน ะฟะพะธัะบ**: ะฟะพ ัะพัะฝัะผ ัะพะฒะฟะฐะดะตะฝะธัะผ ัะปะพะฒ
- ะะพะทะฒัะฐัะฐะตััั ัะพะฟ-5 ะฝะฐะธะฑะพะปะตะต ัะตะปะตะฒะฐะฝัะฝัั ัะฐะฝะบะพะฒ

#### ะจะฐะณ 3: ะะพะฝััััะธัะพะฒะฐะฝะธะต ะฟัะพะผะฟัะฐ
```
ะกะธััะตะผะฐ: ะขั - ัะบัะฟะตัั ะฟะพ ะฟะพะดะดะตัะถะบะต ัะฐะทัะฐะฑะพััะธะบะพะฒ. 
ะัะฟะพะปัะทัะน ัะพะปัะบะพ ะฟัะตะดะพััะฐะฒะปะตะฝะฝัั ะธะฝัะพัะผะฐัะธั ะดะปั ะพัะฒะตัะฐ.

ะะพะฝัะตะบัั:
[ะงะฐะฝะบ 1: ัะตะปะตะฒะฐะฝัะฝะฐั ะธะฝัะพัะผะฐัะธั]
[ะงะฐะฝะบ 2: ะดะพะฟะพะปะฝะธัะตะปัะฝะฐั ะธะฝัะพัะผะฐัะธั]
...

ะะพะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั: [ะฒะพะฟัะพั]

ะัะฒะตัั ะฝะฐ ะพัะฝะพะฒะต ะบะพะฝัะตะบััะฐ. ะัะปะธ ะธะฝัะพัะผะฐัะธะธ ะฝะตะดะพััะฐัะพัะฝะพ, 
ัะบะฐะถะธ ะพะฑ ััะพะผ ัะตััะฝะพ.
```

#### ะจะฐะณ 4: ะะตะฝะตัะฐัะธั ะพัะฒะตัะฐ
- ะัะพะผะฟั ะพัะฟัะฐะฒะปัะตััั ะฒ ะฒัะฑัะฐะฝะฝัั LLM ะผะพะดะตะปั
- ะกะธััะตะผะฐ ะฟะพะดะดะตัะถะธะฒะฐะตั ะฝะตัะบะพะปัะบะพ ะฟัะพะฒะฐะนะดะตัะพะฒ:
  - **GigaChat** (ะพัะฝะพะฒะฝะฐั ะผะพะดะตะปั)
  - **DeepSeek** (ัะตะทะตัะฒะฝะฐั)
  - **OpenAI** (ัะตะทะตัะฒะฝะฐั)
- ะัะปะธ ะพัะฝะพะฒะฝะฐั ะผะพะดะตะปั ะฝะตะดะพัััะฟะฝะฐ, ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะตัะตะบะปััะฐะตััั ะฝะฐ ัะตะทะตัะฒะฝัั

#### ะจะฐะณ 5: ะกะพััะฐะฝะตะฝะธะต ะธ ะพะฑัะฐัะฝะฐั ัะฒัะทั
- ะะพะฟัะพั ะธ ะพัะฒะตั ัะพััะฐะฝััััั ะฒ PostgreSQL
- ะะพะปัะทะพะฒะฐัะตะปั ะผะพะถะตั ะพัะตะฝะธัั ะบะฐัะตััะฒะพ ะพัะฒะตัะฐ
- ะกะธััะตะผะฐ ััะธััั ะฝะฐ ะพะฑัะฐัะฝะพะน ัะฒัะทะธ

## ๐ง ะะปััะตะฒัะต ะบะพะผะฟะพะฝะตะฝัั

### 1. **Embedding Model (`sentence-transformers`)**
- **ะะพะดะตะปั**: `all-MiniLM-L6-v2`
- **ะะฐะทะผะตัะฝะพััั**: 384
- **ะกะบะพัะพััั**: ~2000 ะฟัะตะดะปะพะถะตะฝะธะน/ัะตะบ
- **ะะฐัะตััะฒะพ**: 85% ัะพัะฝะพััั ะฝะฐ ัะตััะฐั ัะตะผะฐะฝัะธัะตัะบะพะณะพ ััะพะดััะฒะฐ

### 2. **Vector Store (ChromaDB)**
- **ะขะธะฟ**: In-memory ั ะฟะตััะธััะตะฝัะฝะพัััั
- **ะะตััะธะบะฐ**: Cosine similarity
- **ะะฝะดะตะบัะฐัะธั**: HNSW (Hierarchical Navigable Small World)
- **ะฅัะฐะฝะตะฝะธะต**: ะะพะบะฐะปัะฝะฐั ะฟะฐะฟะบะฐ `./chroma_db`

### 3. **Document Chunking**
- **ะะฐะทะผะตั ัะฐะฝะบะฐ**: 1000 ัะธะผะฒะพะปะพะฒ
- **ะะตัะตะบัััะธะต**: 200 ัะธะผะฒะพะปะพะฒ
- **ะกััะฐัะตะณะธั**: ะะพ ะฟัะตะดะปะพะถะตะฝะธัะผ ั ัะพััะฐะฝะตะฝะธะตะผ ะบะพะฝัะตะบััะฐ

### 4. **Hybrid Search**
```python
def hybrid_search(query: str, top_k: int = 5):
    # 1. ะะตะบัะพัะฝัะน ะฟะพะธัะบ (70% ะฒะตัะฐ)
    vector_results = vector_search(query, top_k * 2)
    
    # 2. ะะปััะตะฒะพะน ะฟะพะธัะบ (30% ะฒะตัะฐ)
    keyword_results = keyword_search(query, top_k * 2)
    
    # 3. ะะฑัะตะดะธะฝะตะฝะธะต ะธ ัะฐะฝะถะธัะพะฒะฐะฝะธะต
    combined = merge_and_rank(vector_results, keyword_results)
    
    return combined[:top_k]
```

## ๐ API Endpoints

### REST API
- `POST /api/chat/message` - ะัะฟัะฐะฒะบะฐ ัะพะพะฑัะตะฝะธั
- `GET /api/chat/sessions` - ะกะฟะธัะพะบ ัะตััะธะน
- `GET /api/chat/sessions/{id}` - ะะตัะฐะปะธ ัะตััะธะธ
- `GET /api/chat/models` - ะะพัััะฟะฝัะต ะผะพะดะตะปะธ
- `GET /api/chat/stats` - ะกัะฐัะธััะธะบะฐ ัะธััะตะผั

### WebSocket
- `ws://localhost:8000/ws/chat` - ะะตะฐะปัะฝะพะต ะฒัะตะผั ัะฐัะฐ
- `ws://localhost:8000/ws/status` - ะกัะฐััั ัะพะตะดะธะฝะตะฝะธั

## ๐๏ธ ะะฐะทะฐ ะดะฐะฝะฝัั

### ะขะฐะฑะปะธัั PostgreSQL
1. **users** - ะะพะปัะทะพะฒะฐัะตะปะธ ัะธััะตะผั
2. **chat_sessions** - ะกะตััะธะธ ัะฐัะฐ
3. **chat_messages** - ะกะพะพะฑัะตะฝะธั ะฒ ัะตััะธัั
4. **feedback** - ะัะตะฝะบะธ ะพัะฒะตัะพะฒ
5. **knowledge_documents** - ะะตัะฐะดะฐะฝะฝัะต ะดะพะบัะผะตะฝัะพะฒ
6. **system_metrics** - ะะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ

### ะกัะตะผะฐ ะดะฐะฝะฝัั
```sql
-- ะกะตััะธั ัะฐัะฐ
chat_sessions (
    id UUID PRIMARY KEY,
    user_id UUID REFERENCES users(id),
    title VARCHAR(255),
    created_at TIMESTAMP,
    updated_at TIMESTAMP
)

-- ะกะพะพะฑัะตะฝะธั
chat_messages (
    id UUID PRIMARY KEY,
    session_id UUID REFERENCES chat_sessions(id),
    content TEXT,
    role ENUM('user', 'assistant'),
    created_at TIMESTAMP,
    feedback_score INTEGER
)
```

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะะถะธะดะฐะตะผัะต ะผะตััะธะบะธ
- **ะัะตะผั ะพัะฒะตัะฐ**: < 2 ัะตะบัะฝะดั
- **ะขะพัะฝะพััั ะพัะฒะตัะพะฒ**: 85-90%
- **ะะพะบัััะธะต ะฒะพะฟัะพัะพะฒ**: 70-80%
- **ะะฐัะฐะปะปะตะปัะฝัะต ะทะฐะฟัะพัั**: 100+

### ะะฟัะธะผะธะทะฐัะธะธ
1. **ะััะธัะพะฒะฐะฝะธะต**: Redis ะดะปั ัะฐัััั ะทะฐะฟัะพัะพะฒ
2. **ะัะธะฝััะพะฝะฝะพััั**: FastAPI + async/await
3. **ะะตะบัะพัะธะทะฐัะธั**: Batch processing ะดะพะบัะผะตะฝัะพะฒ
4. **ะะฝะดะตะบัะฐัะธั**: HNSW ะดะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะปััะตะฒัะต ะฟะฐัะฐะผะตััั
```env
# ะะฐะทะผะตั ัะฐะฝะบะพะฒ
CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# ะะพะธัะบ
TOP_K_RESULTS=5
SIMILARITY_THRESHOLD=0.7

# ะะพะดะตะปะธ
DEFAULT_MODEL=gigachat
FALLBACK_MODELS=["deepseek", "openai"]
```

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะะตััะธะบะธ
- ะะพะปะธัะตััะฒะพ ะพะฑัะฐะฑะพัะฐะฝะฝัั ะทะฐะฟัะพัะพะฒ
- ะกัะตะดะฝะตะต ะฒัะตะผั ะพัะฒะตัะฐ
- ะขะพัะฝะพััั ะพัะฒะตัะพะฒ (ะฟะพ feedback)
- ะะฐะทะผะตั ะฒะตะบัะพัะฝะพะน ะฑะฐะทั
- ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะผะพะดะตะปะตะน

### ะะพะณะธัะพะฒะฐะฝะธะต
- ะกัััะบัััะธัะพะฒะฐะฝะฝัะต ะปะพะณะธ ั `loguru`
- ะฃัะพะฒะฝะธ: DEBUG, INFO, WARNING, ERROR
- ะะพัะฐัะธั ะปะพะณะพะฒ ะฟะพ ัะฐะทะผะตัั ะธ ะฒัะตะผะตะฝะธ

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะััะตะฝัะธัะธะบะฐัะธั
- JWT ัะพะบะตะฝั
- ะัะตะผั ะถะธะทะฝะธ: 30 ะผะธะฝัั
- ะะปะณะพัะธัะผ: HS256

### ะะฒัะพัะธะทะฐัะธั
- ะะพะปะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- ะะณัะฐะฝะธัะตะฝะธั ะฝะฐ API
- Rate limiting: 60 ะทะฐะฟัะพัะพะฒ/ะผะธะฝััะฐ

### ะะฐัะธัะฐ ะดะฐะฝะฝัั
- ะจะธััะพะฒะฐะฝะธะต API ะบะปััะตะน
- ะะทะพะปััะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- ะะพะณะธัะพะฒะฐะฝะธะต ะดะพัััะฟะฐ

## ๐ ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

### ะะพัะธะทะพะฝัะฐะปัะฝะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต
- ะะฝะพะถะตััะฒะตะฝะฝัะต ะธะฝััะฐะฝัั FastAPI
- Load balancer (Nginx)
- Shared PostgreSQL
- Redis cluster

### ะะตััะธะบะฐะปัะฝะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต
- ะฃะฒะตะปะธัะตะฝะธะต ัะตััััะพะฒ ัะตัะฒะตัะฐ
- ะะฟัะธะผะธะทะฐัะธั ะทะฐะฟัะพัะพะฒ
- ะะฝะดะตะบัั ะฑะฐะทั ะดะฐะฝะฝัั
- ะััะธัะพะฒะฐะฝะธะต

## ๐ ะะธะทะฝะตะฝะฝัะน ัะธะบะป ะดะพะบัะผะตะฝัะฐ

1. **ะะฐะณััะทะบะฐ** โ Confluence API / ัะฐะนะปั
2. **ะัะตะดะพะฑัะฐะฑะพัะบะฐ** โ ะัะธััะบะฐ, ัะพัะผะฐัะธัะพะฒะฐะฝะธะต
3. **ะงะฐะฝะบะธัะพะฒะฐะฝะธะต** โ ะะฐะทะฑะธะตะฝะธะต ะฝะฐ ัะฐััะธ
4. **ะะตะบัะพัะธะทะฐัะธั** โ ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะฒ ะฒะตะบัะพัั
5. **ะะฝะดะตะบัะฐัะธั** โ ะกะพััะฐะฝะตะฝะธะต ะฒ ChromaDB
6. **ะะพะธัะบ** โ ะะพะธัะบ ะฟะพ ะฒะตะบัะพัะฐะผ
7. **ะะฑะฝะพะฒะปะตะฝะธะต** โ ะะตัะธะพะดะธัะตัะบะฐั ัะธะฝััะพะฝะธะทะฐัะธั

## ๐ก ะัััะธะต ะฟัะฐะบัะธะบะธ

### ะะปั ะดะพะบัะผะตะฝัะพะฒ
- ะะฐะทะผะตั: 1000-2000 ัะธะผะฒะพะปะพะฒ ะฝะฐ ัะฐะฝะบ
- ะะฐัะตััะฒะพ: ะะบััะฐะปัะฝะฐั ะธ ัะพัะฝะฐั ะธะฝัะพัะผะฐัะธั
- ะกัััะบัััะฐ: ะะพะณะธัะตัะบะฐั ะณััะฟะฟะธัะพะฒะบะฐ
- ะะตัะฐะดะฐะฝะฝัะต: ะขะตะณะธ, ะบะฐัะตะณะพัะธะธ, ะฒะตััะธะธ

### ะะปั ะฟัะพะผะฟัะพะฒ
- ะะพะฝัะตะบัั: ะะพััะฐัะพัะฝะฐั ะธะฝัะพัะผะฐัะธั
- ะะฝััััะบัะธะธ: ะงะตัะบะธะต ัะบะฐะทะฐะฝะธั ะดะปั LLM
- ะะณัะฐะฝะธัะตะฝะธั: ะงัะพ ะผะพะถะฝะพ ะธ ะฝะตะปัะทั ะดะตะปะฐัั
- ะัะธะผะตัั: ะะพะฝะบัะตัะฝัะต ัะปััะฐะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะะปั ัะฐะทะฒะตัััะฒะฐะฝะธั
- ะะบััะถะตะฝะธั: Dev, Staging, Production
- ะะพะฝะธัะพัะธะฝะณ: Prometheus + Grafana
- ะะพะณะธัะพะฒะฐะฝะธะต: ELK Stack
- Backup: ะะฒัะพะผะฐัะธัะตัะบะพะต ัะตะทะตัะฒะฝะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต
